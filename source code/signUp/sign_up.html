<!DOCTYPE html>
<html lang="en">
<head>
    <title>Sign Up - CC Classroom</title>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/x-icon" href="img/thumbnail.ico" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="../main.js"></script> 
	<link rel="stylesheet" type="text/css" href="../style.css">

	<script>
		let mail;
		let pass;
		let confirmPass;
		let username;
		let hoTen;
		let birth;
		let sdt;
		let avatar;
		let alertError;
		let alertSuccess;
		let errorBirth;
		window.onload = function(){
			makeTextInputFile()
			mail = document.getElementById('email');
			pass = document.getElementById('password');
			confirmPass = document.getElementById('confirm-password');
			username = document.getElementById('username');
			hoTen = document.getElementById('fullname');
			birth = document.getElementById('date-of-birth');
			sdt = document.getElementById('phone-number');
			avatar = document.getElementById('custom-file');
			errorBirth = document.getElementById('errorBirth')
			alertError = document.getElementById('alter-error');
			alertSuccess = document.getElementById('alter-success');
		}

		function checkInformation(){
			if(checkTime(birth.value)){
				errorBirth.style.display = ""
			}else{
				errorBirth.style.display = "none"
				signUp(confirmPass.value, pass.value, avatar.files[0], mail.value, username.value, hoTen.value, birth.value, sdt.value).then(function(result){
				if(result==="File so big"){
					alertError.style.display = ""
					alertError.innerHTML = "File avatar so big"
					alertSuccess.style.display = "none"
				}else if(result.includes("Duplicate entry")){
					alertError.style.display = ""
					alertError.innerHTML = "User has exist"
					alertSuccess.style.display = "none"
				}else if (result === "Insert success"){
					alertError.style.display = "none"
					window.location.href="../index.php"
				}else if (result === "Password and Confirm password not match"){
					alertError.style.display = ""
					alertError.innerHTML = "Password and Confirm password not match"
				}else if(result === "Password must longer 8 characters"){
					alertError.style.display = ""
					alertError.innerHTML = "Password must longer 8 characters"
				}else{
    				alertError.style.display = ""
					alertError.innerHTML = result
					alertSuccess.style.display = "none"
				}
			})
			}
			
		}
		
	</script>


</head>
<body class="text-center bodyLogin">
	
	<form method="post" class="form-signin formSignup" onsubmit='checkInformation();return false' enctype="multipart/form-data">
		<img src="../img/icon.png" alt="icon" width="auto" height="60" class="imgLogin">
		<h3 class="signup"><b>Sign Up</b></h3>

		<label  class="labelSignUp"for="email" >Email</label>     
		<input type="email" name="email" id="email" class="form-control formControlLogin inputPassLogin" placeholder="Email" required autofocus>    

		<label class="labelSignUp" for="password" >Password</label>     
		<input type="password" name="password" id="password" class="form-control formControlLogin inputPassLogin" placeholder="Password" required >   
		
		<label class="labelSignUp" for="confirm-password" >Confirm Password</label>     
		<input type="password" name="confirm_password" id="confirm-password" class="form-control formControlLogin inputPassLogin" placeholder="Confirm Password" required> 

		<label class="labelSignUp" for="username" >Username</label>     
		<input type="text" name="username" id="username" class="form-control formControlLogin inputPassLogin" placeholder="Username" required> 

		<label class="labelSignUp" for="fullname" >Fullname</label>     
		<input type="text" name="fullname" id="fullname" class="form-control formControlLogin inputPassLogin" placeholder="Fullname" required> 

		<label class="labelSignUp" for="date-of-birth" >Date of birth</label>     
		<input type="date" name="date-of-birth" id="date-of-birth" class="form-control formControlLogin inputPassLogin" placeholder="Date of birth" required> 	
		<p style="color: red; margin-top: 5px; margin-bottom: 0px; justify-content: flex-start; font-size: 14px; text-align: left; display: none" id="errorBirth">Your date of birth must not be greater than today.</p>


		<label class="labelSignUp" for="phone-number" >Phone number</label>     
		<input type="tel" name="phone-number" id="phone-number" class="form-control formControlLogin inputPassLogin" placeholder="Phone number" 
		pattern="[0-9]{10}" required> 

		<label class="labelSignUp" for="custom-file" >Choose your profile picture</label> 
		<div class="custom-file">
			<label class="labelSignUp custom-file-label" for="custom-file" style="margin: 0;">Choose file</label>
			<input type='file' name="custom-file" class="custom-file-input inputPassLogin" id="custom-file" accept="image/*" required>			
		</div>

		<button class="btn btn-md btn-block btnSignUp" type="submit" name="submit">Sign Up</button>

		<div class="alert alert-success alertSignUp" style="display: none;" id="alter-success">Information has been saved</div>
		<div class="alert alert-danger alertSignUp" style="display: none;" id="alter-error"></div>
	</form>
	
</body>
</html>